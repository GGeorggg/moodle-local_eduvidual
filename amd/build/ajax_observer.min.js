define(["jquery","core/ajax","core/notification","core/str","core/url","local_eduvidual/main"],function(a,b,c,d,e,f){return{debug:!0,inci:0,questionBankCategoryAddFilter:function(){var b=this;b.inci++,b.debug&&console.log("local_eduvidual/ajax_observer:questionBankCategoryAddFilter(), inci is ",b.inci),d.get_strings([{key:"questioncategoryfilter:label",component:"local_eduvidual"}]).done(function(c){var d="var i = $('#id_filtercategory_"+b.inci+"'); require(['local_eduvidual/main', 'local_eduvidual/ajax_observer'], function(M, OBSERVER) { M.watchValue({ target: i, run: function() { OBSERVER.questionBankCategoryFilter($(i)); } }); }); return false;",f=a('.questionbankformforpopup form[action$="/mod/quiz/edit.php"]:not(".observer-modified")'),g=a('form[action$="/mod/quiz/addrandom.php"]:not(".observer-modified")'),h=a("<label>").attr("for","id_filtercategory_"+b.inci).html(c[0]+":").css("min-width","150px"),i=a("<input>").attr("id","id_filtercategory_"+b.inci).attr("onkeyup",d).attr("style","width: 100%"),j=a("<a>").attr("onclick","$('#id_filtercategory_"+b.inci+"').val('');"+d).attr("style","position: absolute; left: calc(100% - 35px);").append(a("<img>").attr("src",e.relativeUrl("/pix/t/delete.svg")).addClass("icon"));f.length>0&&(a(f).addClass("observer-modified"),a(f).parent().prepend([a("<div>").attr("id","fitem_id_filtercategory").addClass("form-group row fitem filtercategory").append([a("<div>").addClass("col-md-3").append([h]),a("<div>").addClass("col-md-9 form-inline felement").append([i,j])])]),a(f).find("select#id_category, select#id_selectacategory").css({width:"100%"})),g.length>0&&(a(g).addClass("observer-modified"),a(g).find("fieldset#id_existingcategoryheader").prepend([a("<div>").attr("id","fitem_id_filtercategory").addClass("form-group row fitem filtercategory").append([a("<div>").addClass("col-md-3").append([h]),a("<div>").addClass("col-md-9 form-inline felement").append([i,j])])]),a(g).find("select#id_category, select#id_selectacategory").css({width:"100%"}))}).fail(c.exception)},questionBankCategoryFilter:function(b){var c=this,d=a(b).val().toLowerCase(),e=a(b).closest(".modal-body"),f=a(e).find("select#id_category, select#id_selectacategory");return""==d?(a(f).find("option, optgroup").css("display",""),void this.confirmed(a(f),!0,500)):(c.debug&&console.log("Search for ",d," in ",f),a(f).find("optgroup").css("display","none"),a(f).find("option").each(function(b,e){a(e).html().toLowerCase().indexOf(d)===-1?a(e).css("display","none"):(a(e).css("display",""),a(e).parent().css("display","")),c.debug&&console.log(a(e),a(e).html(),a(e).css("display"))}),void this.confirmed(a(f),!0,500))},confirmed:function(b,c,d){"undefined"!=typeof d&&0!=d||(d=1e3),console.log("local_eduvidual/ajax_observer:confirmed(selector, success, timeout)",b,c,d),a(b).css({"background-color":"rgba(0, 255, 0, 0.1)"}),setTimeout(function(){a(b).css({"background-color":""})},d)}}});