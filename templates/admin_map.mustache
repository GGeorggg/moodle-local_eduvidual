 {{!
    tdis file is part of Moodle - http://moodle.org/

    Moodle is free software: you can redistribute it and/or modify
    it under tde terms of tde GNU General Public License as published by
    tde Free Software Foundation, eitder version 3 of tde License, or
    (at your option) any later version.

    Moodle is distributed in tde hope tdat it will be useful,
    but WItdOUT ANY WARRANTY; witdout even tde implied warranty of
    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See tde
    GNU General Public License for more details.

    You should have received a copy of tde GNU General Public License
    along witd Moodle.  If not, see <http://www.gnu.org/licenses/>.
  }}
<div class="block_eduvidual_admin_map" id="{{uniqid}}">
    <h4>{{#str}} admin:map, block_eduvidual {{/str}}</h4>
    <div id="{{uniqid}}-map" style="height: 400px; border: 1px solid #AAA;"></div>
    <div style="text-align: right; margin-bottom: 10px;">
        <div style="display: inline-block;">
                {{#pix}} google-maps-pin-green, block_eduvidual {{/pix}}
                {{#str}} admin:map:eduv, block_eduvidual {{/str}}
        </div>
        <div style="display: inline-block;">
            {{#pix}} google-maps-pin-orange, block_eduvidual {{/pix}}
            {{#str}} admin:map:both, block_eduvidual {{/str}}
        </div>
        <div style="display: inline-block;">
            {{#pix}} google-maps-pin-blue, block_eduvidual {{/pix}}
            {{#str}} admin:map:lpf, block_eduvidual {{/str}}
        </div>
    </div>
    <input type="checkbox" id="{{uniqid}}-include-nonegroup"
        onchange="require(['block_eduvidual/admin'], function(ADMIN) { ADMIN.org_gps('{{uniqid}}'); });"/>
        <label for="{{uniqid}}-include-nonegroup">{{#str}} admin:map:includenonegroup, block_eduvidual {{/str}}</label>
    <input type="checkbox" id="{{uniqid}}-count-invisibles"
        onchange="require(['block_eduvidual/admin'], function(ADMIN) { ADMIN.org_gps_refresh('{{uniqid}}'); });"/>
    <label for="{{uniqid}}-count-invisibles">{{#str}} admin:map:count_invisibles, block_eduvidual {{/str}}</label>
    <div id="{{uniqid}}-legend" style="height: unset; /*position: absolute; margin-top: 2px; margin-left: 1px; */ z-index: 999;  background-color: rgba(255, 255,255, 0.8); overflow: hidden;">
        <div class="grid-eq-{{filters_count}}">
            {{#filters}}
            <table border="0" class="generaltable {{filterid}}">
                <tfoot>
                    <th width="30">&nbsp;</th>
                    <th class="sum">{{#str}} all {{/str}}</th>
                    <td class="sum" align="right"></td>
                </tfoot>
                <tbody>
                    {{#selections}}
                    <tr>
                        <th>
                            <input type="checkbox" id="{{uniqid}}-trigger-{{key}}" class="trigger" data-trigger-key="{{key}}" data-filterid="{{filterid}}"
                                {{#checked}} checked="checked" {{/checked}}
                                onchange="require(['block_eduvidual/admin'], function(ADMIN) { ADMIN.org_gps_refresh('{{uniqid}}'); });"/>
                            </a>
                        </th>
                        <th class="{{key}}"><label for="{{uniqid}}-trigger-{{key}}">{{{icon}}}{{label}}</label></th>
                        <td class="{{key}}" align="right"></td>
                    </tr>
                    {{/selections}}
                </tbody>
            </table>
            {{/filters}}
        </div>
        <!--
        <div>
            <a href="#" onclick="var a = this; var h = a.offsetHeight; require(['jquery'], function($) { $(a).toggleClass('minified'); $('#{{uniqid}}-legend').css('height', $(a).hasClass('minified') ? h + 'px' : 'unset'); } ); return false;" style="float: right;">
                {{#pix}} t/switch_whole, core, show info {{/pix}}
            </a>
            <a href="#" onclick="require(['block_eduvidual/admin'], function(ADMIN) { ADMIN.org_gps_refresh('{{uniqid}}'); }); return false;" style="float: right;">
                {{#pix}} i/reload, core, reload {{/pix}}
            </a>
        </div>
        -->
    </div>
</div>

{{#js}}
require(['block_eduvidual/admin', 'block_eduvidual/leaflet'], function(ADMIN) {
    ADMIN.org_gps("{{uniqid}}");
});
{{/js}}
